# honeypot_simulation\\3.

<b>Modules</b>

1 Client
 This module is the the honeypot client. End User attempt to login to the Backend Server using this component.
 A new user can be registered using the “Register” Button which redirects to the Registration Module.
 A registered user can attempt access to the Backend Server by providing the proper credentials.
 
 
2 POOH Server (Honeypot)
 This module captures the user credentials and the activity of the user.
 Firstly, the system verifies them against the registered user database.
o If there is a username/password mismatch appropriate error message is displayed.
o If the user is not registered, the error message generated is “Invalid User”.
o If proper credentials are supplied, then the activity of the user is checked in the
next step.
 The second step of granting access to any user is checking the activity generated by the
user.
 This activity checking has two steps as follows:
o Check if the login instance is opening multiple TCP connections on the honeypot machine. The threshold for detecting an attack was determined empirically for our set-up. The value finalised on was 50 open TCP connections. This step detects
only SYN flooding attacks.
o If the preliminary check was passed, i.e. an “Operations are Normal” was
identified, then the system intelligently detects the presence of an attack, and the
Attack Type, if one is found.
 All Login Activity is logged into the log file, Attack_Log.txt with the general format as:
o Timestamp of the Login Attempt.
o Numbers of TCP Connections open. o Source IP of the Login Attempt.
 If the activity of the user is found to be Malicious, then the user is blocked out of the system, the entire details of the source of attack are logged into the log file along with the general format as specified below:
o Attack Type
o Attack Group
o Attacker’s IP Address
 If the User is Benign, then user is granted access to the backend server, where he can perform the operations on the backend data.


3 Backend Server
 Contains the backend data.
 Protected by Honeypot
 No interaction with the Attacker.
 
 
4. Resources Utilized
There were several tools which were used in the course of building this system. To contribute to the novelty of our project, minimal external resources have been utilized. We have fruitfully attempted to create a majority of the employed tools ourselves. We have used the Apache POI library, for manipulating various file formats based upon the Office Open XML standards (OOXML) and Microsoft's OLE 2 Compound Document format (OLE2). Apache POI is your Java Excel solution (for Excel 97-2008).
4.1 Apache POI
 A major use of the Apache POI API is for Text Extraction applications such as web spiders, index builders, and content management systems. In our use case, it is used to handle the data being read from/written to XLSX files for the purpose of Attack Detection and Blocking of Malicious Users. There were two classes in the Apache POI library which were extensively used in the project:
o XSSF: This class’s instance was used to perform the read/write functions and parsing of the XLSX files.
o HSSF: This class’s instance was used to create the CSV file, Machine_Python.csv, which contained the input for the Learning Agent.
 Overview to these Classes:
o HSSF is the POI Project's pure Java implementation of the Excel '97(-2007) file
format. XSSF is the POI Project's pure Java implementation of the Excel 2007 OOXML (.xlsx) file format. HSSF and XSSF provide ways to read spreadsheets create, modify, read and write XLS spreadsheets. They provide:
 Low level structures for those with special needs
 An eventmodel API for efficient read-only access
 A full usermodel API for creating, reading and modifying XLS files
o To read the spreadsheet data, eventmodel API in either the org.apache.poi.hssf.eventusermodel package, or the org.apache.poi.xssf.eventusermodel package, is used depending on the file format.
o To modify the spreadsheet data then the usermodel API is used. Note that the usermodel system has a higher memory footprint than the low level eventusermodel, but has the major advantage of being much simpler to work with. Also, the new XSSF supported Excel 2007 OOXML (.xlsx) files are XML based, the memory footprint for processing them is higher than for the older HSSF supported (.xls) binary files.
 JAR files utilised: o poi-3.15.jar
o poi-ooxml-3.15.jar
o poi-ooxml-schemas-3.15.jar o xmlbeans-2.6.0.jar
4.2 Apache Commons
 Apache Commons is an Apache project focused on all aspects of reusable Java components.
 The Apache Commons project is composed of three parts:
o The Commons Proper - A repository of reusable Java components.
o The Commons Sandbox - A workspace for Java component development.
o The Commons Dormant - A repository of components that are currently
inactive.
 The Apache Commons source code repositories are writable for all ASF committers.
While Apache Commons is a Commit-Then-Review community, we would consider it polite and helpful for contributors to announce their intentions and plans on the dev mailing list before committing code. All contributors should read our contributing guidelines.
 JAR files utilised:
o commons-codec-1.10.jar
o commons-collection-4- 4.1.jar o commons-logging-1.2.jar
o junit-4.12.jar
o log4j-1.2.17.jar
5. Intelligent Intrusion Detection Using Machine Learning
Machine learning (ML) is a subfield of artificial intelligence that evolved from the study of pattern recognition and computational learning theory. In 1959, Arthur Samuel defined machine learning as a "Field of study that gives computers the ability to learn without being explicitly programmed". Machine learning is a method of data analysis that automates analytical model building. Using algorithms that iteratively learn from data, machine learning allows computers to find hidden insights without being explicitly programmed where to look. It explores the study and construction of algorithms that can learn from and make predictions on data. Such algorithms operate by building a model from an example training set of input observations in order to make data-driven predictions or decisions expressed as outputs, rather than following strictly static program instructions. A computer program is said to learn from experience with respect to some class of tasks and performance measure if its performance at tasks, as measured, improves with experience.


5.1 Learning Model
After testing a variety of methods for classification, Random Forests were found to be the most suitable for this project. Random forests or random decision forests are an ensemble learning method for classification, regression and other tasks, that operate by constructing a multitude of decision trees at training time and outputting the class that is the mode of the classes (classification) or mean prediction (regression) of the individual trees. Random decision forests correct for decision trees' habit of overfitting to their training set.

5.2 Dataset
The NSL-KDD dataset has been used for the task of training our model. The training data consists of 5 million records (4 GB). The dataset consists of live traffic recorded over a period of a week and consists records of the following types of attacks.

 Denial of Service Attack (DoS): 
o back
o land
o neptune o pod
o smurf
o teardrop
 User to Root Attack (U2R): unauthorized access to local superuser (root) privileges o buffer_overflow
o loadmodule o perl
o rootkit
 Remote to Local Attack (R2L): unauthorized access from a remote machine o ftp_write
o guess_passwd o imap
o multihop
o phf
o spy
o warezclient
      
o warezmaster
 Probing Attack: surveillance and other probing
o ipsweep
o nmap
o portsweep o satan


5.3 Performance
The model performed with a 99.8% accuracy on the live test data.
